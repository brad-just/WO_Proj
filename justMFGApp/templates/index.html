{% extends "layout.html" %}


{% block content %}


<!-- Top Table -->

<div id="topTable" class="row table-responsive no-gutters">
  <table class="table-striped table-sm">
    <thead class="bg-dark-grey">
      <tr>

        <th scope="col">#</th>

        {% for col in bowlcust_orders.header %}

          {% if col != 'LongDesc' %}

            <th id="top-table-{{ col }}" scope="col"><form method="post" action="{{ url_for('index', _anchor=col) }}"><input class="btn btn-link btn-sm" type="submit" name="top_key" value="{{ col }}"></form></th>

          {% endif %}

        {% endfor %}

      </tr>
    </thead>

    <tbody class="table-bordered">
      {% for order in bowlcust_orders.data %}
        {% set outer_index = loop.index %}
        <tr>
          <th id="bowlcust-{{ outer_index }}-index" nowrap scope="row">{{ outer_index }}</th>
        {% for entry in bowlcust_orders.header %}

          {% if entry == "ItemID" %}

            <td id="bowlcust-{{ outer_index }}-{{ entry }}" nowrap><button type="button" class="btn btn-link" data-toggle="modal" data-target="#top-modal-{{ outer_index }}">{{ order['ItemID'] }}</button></td>
            <!-- Modal -->
            <div class="modal fade" id="top-modal-{{ outer_index }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
              <div class="modal-dialog modal-lg bg-cream" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">{{ order['ItemID'] }}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <embed src="{{ url_for('pdfs.static', filename=order['ItemID']+'.pdf') }}" frameborder="0" width="100%" height="700px">
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  </div>
                </div>
              </div>
            </div>

          {% elif entry == "ShortDesc" %}

            <td id="bowlcust-{{ outer_index }}-{{ entry }}" nowrap><button tabindex="0" type="button" class="btn btn-link" data-toggle="popover" data-trigger="focus" title="Long Description" data-content="{{ order['LongDesc'] }}">{{ order['ShortDesc'] }}</button></td>

          {% elif entry != "LongDesc" %}

            <td id="bowlcust-{{ outer_index }}-{{ entry }}" nowrap>{{ order[entry] }}</td>

          {% endif %}
        {% endfor %}

        </tr>

      {% endfor %}
    </tbody>

  </table>
</div>

<!-- Bottom Table -->

<div id="bottomTable" class="row table-responsive no-gutters">
  <table class="table table-striped table-sm">
    <thead class="bg-dark-grey">
      <tr>

        <th scope="col">#</th>

        {% for col in gen_orders.header %}

          {% if col != 'LongDesc' %}

            <th id="bottom-table-{{ col }}"scope="col"><form method="post" action="{{ url_for('index', _anchor=col) }}"><input class="btn btn-link btn-sm" type="submit" name="bottom_key" value="{{ col }}"></form></th>

          {% endif %}

        {% endfor %}

      </tr>
    </thead>

    <tbody class="table-bordered">
      {% for order in gen_orders.data %}
        {% set outer_index = loop.index %}
        <tr>
          <th id="gen-{{ outer_index }}-index" nowrap scope="row">{{ outer_index }}</th>
        {% for entry in gen_orders.header %}

          {% if entry == "ItemID" %}

            <td id="gen-{{ outer_index }}-{{ entry }}" nowrap><button type="button" class="btn btn-link" data-toggle="modal" data-target="#bottom-modal-{{ outer_index }}">{{ order['ItemID'] }}</button></td>
            <!-- Modal -->
            <div class="modal fade" id="bottom-modal-{{ outer_index }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
              <div class="modal-dialog modal-lg bg-cream" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">{{ order['ItemID'] }}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <embed src="{{ url_for('pdfs.static', filename=order['ItemID']+'.pdf') }}" frameborder="0" width="100%" height="700px">
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  </div>
                </div>
              </div>
            </div>

          {% elif entry == "ShortDesc" %}

            <td id="gen-{{ outer_index }}-{{ entry }}" nowrap><button tabindex="0" type="button" class="btn btn-link" data-toggle="popover" data-trigger="focus" title="Long Description" data-content="{{ order['LongDesc'] }}">{{ order['ShortDesc'] }}</button></td>

          {% elif entry != "LongDesc" %}

            <td id="gen-{{ outer_index }}-{{ entry }}" nowrap>{{ order[entry] }}</td>

          {% endif %}
        {% endfor %}

        </tr>

      {% endfor %}
    </tbody>

  </table>
</div>

<!-- Set maximum table heights dynamically -->

<script>
    $("#topTable").css("max-height", $(window).height() * .3);
    $("#bottomTable").css("max-height", $(window).height() * .7);
</script>

{% for order in bowlcust_orders.data %}
  {% set outer_index = loop.index %}

  <script>$("#bowlcust-{{ outer_index }}-index").width($("#gen-1-index").width());</script>

  {% for entry in bowlcust_orders.header %}

    {% if entry != "LongDesc" %}

      <script>$("#bowlcust-{{ outer_index }}-{{ entry }}").width($("#gen-1-{{ entry }}").width());</script>

    {% endif %}

  {% endfor %}
{% endfor %}

{% endblock content %}
